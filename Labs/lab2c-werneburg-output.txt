.headers on

-- Name:  Dakin Werneburg
-- File:  lab2c-werneburg.sql
---Date:  January 25, 2021

--1. List the employee IDs with the number of sales by each employee from most sales to lease.  I want to recognize the employees with the most sales.
select employeeid, count(orderid) from orders group by employeeid order by count(orderid) desc;
EmployeeID|count(orderid)
4|156
3|127
1|123
8|104
2|96
7|72
6|67
9|43
5|42

--2. I want to look at the average discounts taken by all customers for products that cost more than $50.00.  Specifically, I want to know the average discount of all orders for each product from the highest price to the lowest price.

select productid, unitprice, printf("%.2f",avg(discount)) as average_discount from order_details  where unitprice > 50 group by productid order by unitprice desc;
ProductID|UnitPrice|average_discount
38|210.8|0.05
29|99.0|0.06
9|77.6|0.10
20|64.8|0.05
18|62.5|0.09
59|55.0|0.04
51|53.0|0.05

--3. I am doing an analysis of which shippers ship to each country, and I need a report showing the number of orders each shipper delivered to each country and the nuber of orders. I donâ€™t need the data where the number of orders is ten or less, but I need the report listed by country and the number of orders shipped to that country.

select shipcountry, count(orderid) as total_orders, shipperid from orders group by shipperid, shipcountry having count(orderid) > 10 order by shipcountry, count(orderid) desc;
ShipCountry|total_orders|ShipperID
Austria|15|2
Austria|13|3
Austria|12|1
Brazil|35|2
Brazil|31|1
Brazil|17|3
Canada|16|3
France|29|2
France|27|1
France|21|3
Germany|53|2
Germany|41|1
Germany|28|3
Italy|14|1
Mexico|14|3
Sweden|15|2
Sweden|14|1
UK|23|2
UK|22|3
UK|11|1
USA|51|2
USA|40|3
USA|31|1
Venezuela|17|1
Venezuela|16|2
Venezuela|13|3

--4. For each order, what was the time lag between the order date and the ship date?

select orderid, orderdate, shippeddate, julianday(shippeddate)-julianday(orderdate) as lag from orders where shippeddate  order by lag desc;
OrderID|OrderDate|ShippedDate|lag
10660|1997-09-08|1997-10-15|37.0
10777|1997-12-15|1998-01-21|37.0
10380|1996-12-12|1997-01-16|35.0
10427|1997-01-27|1997-03-03|35.0
10545|1997-05-22|1997-06-26|35.0
10593|1997-07-09|1997-08-13|35.0
10924|1998-03-04|1998-04-08|35.0
10309|1996-09-19|1996-10-23|34.0
10705|1997-10-15|1997-11-18|34.0
10709|1997-10-17|1997-11-20|34.0
10927|1998-03-05|1998-04-08|34.0
10366|1996-11-28|1996-12-30|32.0
10423|1997-01-23|1997-02-24|32.0
10441|1997-02-10|1997-03-14|32.0
10483|1997-03-24|1997-04-25|32.0
10596|1997-07-11|1997-08-12|32.0
10726|1997-11-03|1997-12-05|32.0
10727|1997-11-03|1997-12-05|32.0
10578|1997-06-24|1997-07-25|31.0
10970|1998-03-24|1998-04-24|31.0
10264|1996-07-24|1996-08-23|30.0
10515|1997-04-23|1997-05-23|30.0
10687|1997-09-30|1997-10-30|30.0
10807|1997-12-31|1998-01-30|30.0
10271|1996-08-01|1996-08-30|29.0
10280|1996-08-14|1996-09-12|29.0
10302|1996-09-10|1996-10-09|29.0
10433|1997-02-03|1997-03-04|29.0
10523|1997-05-01|1997-05-30|29.0
10749|1997-11-20|1997-12-19|29.0
10779|1997-12-16|1998-01-14|29.0
10816|1998-01-06|1998-02-04|29.0
10788|1997-12-22|1998-01-19|28.0
10840|1998-01-19|1998-02-16|28.0
10978|1998-03-26|1998-04-23|28.0
10508|1997-04-16|1997-05-13|27.0
10795|1997-12-24|1998-01-20|27.0
10305|1996-09-13|1996-10-09|26.0
10568|1997-06-13|1997-07-09|26.0
10723|1997-10-30|1997-11-25|26.0
10540|1997-05-19|1997-06-13|25.0
10569|1997-06-16|1997-07-11|25.0
10826|1998-01-12|1998-02-06|25.0
10827|1998-01-12|1998-02-06|25.0
10875|1998-02-06|1998-03-03|25.0
10370|1996-12-03|1996-12-27|24.0
10514|1997-04-22|1997-05-16|24.0
10704|1997-10-14|1997-11-07|24.0
10407|1997-01-07|1997-01-30|23.0
10536|1997-05-14|1997-06-06|23.0
10663|1997-09-10|1997-10-03|23.0
10678|1997-09-23|1997-10-16|23.0
10771|1997-12-10|1998-01-02|23.0
10350|1996-11-11|1996-12-03|22.0
10828|1998-01-13|1998-02-04|22.0
10951|1998-03-16|1998-04-07|22.0
10986|1998-03-30|1998-04-21|22.0
10371|1996-12-03|1996-12-24|21.0
10425|1997-01-24|1997-02-14|21.0
10447|1997-02-14|1997-03-07|21.0
10451|1997-02-19|1997-03-12|21.0
10475|1997-03-14|1997-04-04|21.0
10525|1997-05-02|1997-05-23|21.0
10603|1997-07-18|1997-08-08|21.0
10824|1998-01-09|1998-01-30|21.0
10980|1998-03-27|1998-04-17|21.0
10450|1997-02-19|1997-03-11|20.0
10482|1997-03-21|1997-04-10|20.0
10796|1997-12-25|1998-01-14|20.0
10912|1998-02-26|1998-03-18|20.0
10960|1998-03-19|1998-04-08|20.0
11022|1998-04-14|1998-05-04|20.0
10322|1996-10-04|1996-10-23|19.0
10502|1997-04-10|1997-04-29|19.0
10691|1997-10-03|1997-10-22|19.0
10708|1997-10-17|1997-11-05|19.0
10847|1998-01-22|1998-02-10|19.0
10868|1998-02-04|1998-02-23|19.0
10966|1998-03-20|1998-04-08|19.0
10265|1996-07-25|1996-08-12|18.0
10440|1997-02-10|1997-02-28|18.0
10757|1997-11-27|1997-12-15|18.0
10861|1998-01-30|1998-02-17|18.0
10932|1998-03-06|1998-03-24|18.0
10506|1997-04-15|1997-05-02|17.0
10571|1997-06-17|1997-07-04|17.0
10582|1997-06-27|1997-07-14|17.0
10653|1997-09-02|1997-09-19|17.0
10886|1998-02-13|1998-03-02|17.0
10405|1997-01-06|1997-01-22|16.0
10320|1996-10-03|1996-10-18|15.0
10400|1997-01-01|1997-01-16|15.0
10462|1997-03-03|1997-03-18|15.0
10793|1997-12-24|1998-01-08|15.0
10863|1998-02-02|1998-02-17|15.0
10977|1998-03-26|1998-04-10|15.0
10563|1997-06-10|1997-06-24|14.0
10642|1997-08-22|1997-09-05|14.0
10759|1997-11-28|1997-12-12|14.0
10775|1997-12-12|1997-12-26|14.0
10898|1998-02-20|1998-03-06|14.0
10998|1998-04-03|1998-04-17|14.0
10293|1996-08-29|1996-09-11|13.0
10357|1996-11-19|1996-12-02|13.0
10856|1998-01-28|1998-02-10|13.0
10928|1998-03-05|1998-03-18|13.0
10931|1998-03-06|1998-03-19|13.0
11004|1998-04-07|1998-04-20|13.0
11026|1998-04-15|1998-04-28|13.0
10248|1996-07-04|1996-07-16|12.0
10254|1996-07-11|1996-07-23|12.0
10330|1996-10-16|1996-10-28|12.0
10353|1996-11-13|1996-11-25|12.0
10417|1997-01-16|1997-01-28|12.0
10489|1997-03-28|1997-04-09|12.0
10509|1997-04-17|1997-04-29|12.0
10610|1997-07-25|1997-08-06|12.0
10624|1997-08-07|1997-08-19|12.0
10638|1997-08-20|1997-09-01|12.0
10648|1997-08-28|1997-09-09|12.0
10674|1997-09-18|1997-09-30|12.0
10740|1997-11-13|1997-11-25|12.0
10900|1998-02-20|1998-03-04|12.0
10909|1998-02-26|1998-03-10|12.0
10930|1998-03-06|1998-03-18|12.0
10940|1998-03-11|1998-03-23|12.0
10982|1998-03-27|1998-04-08|12.0
11010|1998-04-09|1998-04-21|12.0
10261|1996-07-19|1996-07-30|11.0
10288|1996-08-23|1996-09-03|11.0
10316|1996-09-27|1996-10-08|11.0
10361|1996-11-22|1996-12-03|11.0
10411|1997-01-10|1997-01-21|11.0
10416|1997-01-16|1997-01-27|11.0
10531|1997-05-08|1997-05-19|11.0
10574|1997-06-19|1997-06-30|11.0
10604|1997-07-18|1997-07-29|11.0
10657|1997-09-04|1997-09-15|11.0
10735|1997-11-10|1997-11-21|11.0
10797|1997-12-25|1998-01-05|11.0
10961|1998-03-19|1998-03-30|11.0
11029|1998-04-16|1998-04-27|11.0
10260|1996-07-19|1996-07-29|10.0
10274|1996-08-06|1996-08-16|10.0
10312|1996-09-23|1996-10-03|10.0
10313|1996-09-24|1996-10-04|10.0
10317|1996-09-30|1996-10-10|10.0
10340|1996-10-29|1996-11-08|10.0
10360|1996-11-22|1996-12-02|10.0
10396|1996-12-27|1997-01-06|10.0
10398|1996-12-30|1997-01-09|10.0
10419|1997-01-20|1997-01-30|10.0
10426|1997-01-27|1997-02-06|10.0
10434|1997-02-03|1997-02-13|10.0
10464|1997-03-04|1997-03-14|10.0
10492|1997-04-01|1997-04-11|10.0
10510|1997-04-18|1997-04-28|10.0
10518|1997-04-25|1997-05-05|10.0
10526|1997-05-05|1997-05-15|10.0
10533|1997-05-12|1997-05-22|10.0
10541|1997-05-19|1997-05-29|10.0
10547|1997-05-23|1997-06-02|10.0
10556|1997-06-03|1997-06-13|10.0
10575|1997-06-20|1997-06-30|10.0
10589|1997-07-04|1997-07-14|10.0
10627|1997-08-11|1997-08-21|10.0
10651|1997-09-01|1997-09-11|10.0
10666|1997-09-12|1997-09-22|10.0
10692|1997-10-03|1997-10-13|10.0
10712|1997-10-21|1997-10-31|10.0
10729|1997-11-04|1997-11-14|10.0
10736|1997-11-11|1997-11-21|10.0
10767|1997-12-05|1997-12-15|10.0
10798|1997-12-26|1998-01-05|10.0
10799|1997-12-26|1998-01-05|10.0
10800|1997-12-26|1998-01-05|10.0
10805|1997-12-30|1998-01-09|10.0
10812|1998-01-02|1998-01-12|10.0
10829|1998-01-13|1998-01-23|10.0
10865|1998-02-02|1998-02-12|10.0
10877|1998-02-09|1998-02-19|10.0
10905|1998-02-24|1998-03-06|10.0
10916|1998-02-27|1998-03-09|10.0
10923|1998-03-03|1998-03-13|10.0
10933|1998-03-06|1998-03-16|10.0
10965|1998-03-20|1998-03-30|10.0
10967|1998-03-23|1998-04-02|10.0
10983|1998-03-27|1998-04-06|10.0
10988|1998-03-31|1998-04-10|10.0
10997|1998-04-03|1998-04-13|10.0
11002|1998-04-06|1998-04-16|10.0
11015|1998-04-10|1998-04-20|10.0
11023|1998-04-14|1998-04-24|10.0
11030|1998-04-17|1998-04-27|10.0
11049|1998-04-24|1998-05-04|10.0
10269|1996-07-31|1996-08-09|9.0
10286|1996-08-21|1996-08-30|9.0
10300|1996-09-09|1996-09-18|9.0
10314|1996-09-25|1996-10-04|9.0
10319|1996-10-02|1996-10-11|9.0
10351|1996-11-11|1996-11-20|9.0
10356|1996-11-18|1996-11-27|9.0
10378|1996-12-10|1996-12-19|9.0
10393|1996-12-25|1997-01-03|9.0
10394|1996-12-25|1997-01-03|9.0
10401|1997-01-01|1997-01-10|9.0
10415|1997-01-15|1997-01-24|9.0
10422|1997-01-22|1997-01-31|9.0
10429|1997-01-29|1997-02-07|9.0
10444|1997-02-12|1997-02-21|9.0
10449|1997-02-18|1997-02-27|9.0
10465|1997-03-05|1997-03-14|9.0
10544|1997-05-21|1997-05-30|9.0
10550|1997-05-28|1997-06-06|9.0
10551|1997-05-28|1997-06-06|9.0
10579|1997-06-25|1997-07-04|9.0
10585|1997-07-01|1997-07-10|9.0
10591|1997-07-07|1997-07-16|9.0
10606|1997-07-22|1997-07-31|9.0
10608|1997-07-23|1997-08-01|9.0
10620|1997-08-05|1997-08-14|9.0
10626|1997-08-11|1997-08-20|9.0
10654|1997-09-02|1997-09-11|9.0
10662|1997-09-09|1997-09-18|9.0
10664|1997-09-10|1997-09-19|9.0
10672|1997-09-17|1997-09-26|9.0
10719|1997-10-27|1997-11-05|9.0
10730|1997-11-05|1997-11-14|9.0
10745|1997-11-18|1997-11-27|9.0
10751|1997-11-24|1997-12-03|9.0
10760|1997-12-01|1997-12-10|9.0
10772|1997-12-10|1997-12-19|9.0
10780|1997-12-16|1997-12-25|9.0
10789|1997-12-22|1997-12-31|9.0
10791|1997-12-23|1998-01-01|9.0
10794|1997-12-24|1998-01-02|9.0
10814|1998-01-05|1998-01-14|9.0
10815|1998-01-05|1998-01-14|9.0
10819|1998-01-07|1998-01-16|9.0
10831|1998-01-14|1998-01-23|9.0
10841|1998-01-20|1998-01-29|9.0
10842|1998-01-20|1998-01-29|9.0
10845|1998-01-21|1998-01-30|9.0
10854|1998-01-27|1998-02-05|9.0
10857|1998-01-28|1998-02-06|9.0
10866|1998-02-03|1998-02-12|9.0
10870|1998-02-04|1998-02-13|9.0
10882|1998-02-11|1998-02-20|9.0
10917|1998-03-02|1998-03-11|9.0
10918|1998-03-02|1998-03-11|9.0
10925|1998-03-04|1998-03-13|9.0
10935|1998-03-09|1998-03-18|9.0
10936|1998-03-09|1998-03-18|9.0
10941|1998-03-11|1998-03-20|9.0
10953|1998-03-16|1998-03-25|9.0
10957|1998-03-18|1998-03-27|9.0
10958|1998-03-18|1998-03-27|9.0
10968|1998-03-23|1998-04-01|9.0
10971|1998-03-24|1998-04-02|9.0
10974|1998-03-25|1998-04-03|9.0
10976|1998-03-25|1998-04-03|9.0
10993|1998-04-01|1998-04-10|9.0
11025|1998-04-15|1998-04-24|9.0
11038|1998-04-21|1998-04-30|9.0
11042|1998-04-22|1998-05-01|9.0
10263|1996-07-23|1996-07-31|8.0
10267|1996-07-29|1996-08-06|8.0
10284|1996-08-19|1996-08-27|8.0
10291|1996-08-27|1996-09-04|8.0
10295|1996-09-02|1996-09-10|8.0
10296|1996-09-03|1996-09-11|8.0
10301|1996-09-09|1996-09-17|8.0
10307|1996-09-17|1996-09-25|8.0
10321|1996-10-03|1996-10-11|8.0
10329|1996-10-15|1996-10-23|8.0
10348|1996-11-07|1996-11-15|8.0
10363|1996-11-26|1996-12-04|8.0
10364|1996-11-26|1996-12-04|8.0
10391|1996-12-23|1996-12-31|8.0
10392|1996-12-24|1997-01-01|8.0
10395|1996-12-26|1997-01-03|8.0
10399|1996-12-31|1997-01-08|8.0
10402|1997-01-02|1997-01-10|8.0
10431|1997-01-30|1997-02-07|8.0
10438|1997-02-06|1997-02-14|8.0
10473|1997-03-13|1997-03-21|8.0
10474|1997-03-13|1997-03-21|8.0
10477|1997-03-17|1997-03-25|8.0
10478|1997-03-18|1997-03-26|8.0
10484|1997-03-24|1997-04-01|8.0
10491|1997-03-31|1997-04-08|8.0
10493|1997-04-02|1997-04-10|8.0
10495|1997-04-03|1997-04-11|8.0
10499|1997-04-08|1997-04-16|8.0
10500|1997-04-09|1997-04-17|8.0
10535|1997-05-13|1997-05-21|8.0
10559|1997-06-05|1997-06-13|8.0
10592|1997-07-08|1997-07-16|8.0
10605|1997-07-21|1997-07-29|8.0
10628|1997-08-12|1997-08-20|8.0
10629|1997-08-12|1997-08-20|8.0
10643|1997-08-25|1997-09-02|8.0
10655|1997-09-03|1997-09-11|8.0
10668|1997-09-15|1997-09-23|8.0
10686|1997-09-30|1997-10-08|8.0
10698|1997-10-09|1997-10-17|8.0
10702|1997-10-13|1997-10-21|8.0
10711|1997-10-21|1997-10-29|8.0
10720|1997-10-28|1997-11-05|8.0
10731|1997-11-06|1997-11-14|8.0
10748|1997-11-20|1997-11-28|8.0
10770|1997-12-09|1997-12-17|8.0
10778|1997-12-16|1997-12-24|8.0
10792|1997-12-23|1997-12-31|8.0
10804|1997-12-30|1998-01-07|8.0
10808|1998-01-01|1998-01-09|8.0
10822|1998-01-08|1998-01-16|8.0
10830|1998-01-13|1998-01-21|8.0
10833|1998-01-15|1998-01-23|8.0
10855|1998-01-27|1998-02-04|8.0
10867|1998-02-03|1998-02-11|8.0
10880|1998-02-10|1998-02-18|8.0
10883|1998-02-12|1998-02-20|8.0
10896|1998-02-19|1998-02-27|8.0
10902|1998-02-23|1998-03-03|8.0
10903|1998-02-24|1998-03-04|8.0
10908|1998-02-26|1998-03-06|8.0
10943|1998-03-11|1998-03-19|8.0
10952|1998-03-16|1998-03-24|8.0
10996|1998-04-02|1998-04-10|8.0
11000|1998-04-06|1998-04-14|8.0
11001|1998-04-06|1998-04-14|8.0
11006|1998-04-07|1998-04-15|8.0
11012|1998-04-09|1998-04-17|8.0
11044|1998-04-23|1998-05-01|8.0
11050|1998-04-27|1998-05-05|8.0
10251|1996-07-08|1996-07-15|7.0
10259|1996-07-18|1996-07-25|7.0
10273|1996-08-05|1996-08-12|7.0
10281|1996-08-14|1996-08-21|7.0
10283|1996-08-16|1996-08-23|7.0
10290|1996-08-27|1996-09-03|7.0
10299|1996-09-06|1996-09-13|7.0
10303|1996-09-11|1996-09-18|7.0
10306|1996-09-16|1996-09-23|7.0
10310|1996-09-20|1996-09-27|7.0
10315|1996-09-26|1996-10-03|7.0
10323|1996-10-07|1996-10-14|7.0
10333|1996-10-18|1996-10-25|7.0
10334|1996-10-21|1996-10-28|7.0
10339|1996-10-28|1996-11-04|7.0
10341|1996-10-29|1996-11-05|7.0
10345|1996-11-04|1996-11-11|7.0
10349|1996-11-08|1996-11-15|7.0
10358|1996-11-20|1996-11-27|7.0
10369|1996-12-02|1996-12-09|7.0
10386|1996-12-18|1996-12-25|7.0
10418|1997-01-17|1997-01-24|7.0
10428|1997-01-28|1997-02-04|7.0
10432|1997-01-31|1997-02-07|7.0
10437|1997-02-05|1997-02-12|7.0
10442|1997-02-11|1997-02-18|7.0
10445|1997-02-13|1997-02-20|7.0
10448|1997-02-17|1997-02-24|7.0
10455|1997-02-24|1997-03-03|7.0
10466|1997-03-06|1997-03-13|7.0
10471|1997-03-11|1997-03-18|7.0
10472|1997-03-12|1997-03-19|7.0
10476|1997-03-17|1997-03-24|7.0
10486|1997-03-26|1997-04-02|7.0
10494|1997-04-02|1997-04-09|7.0
10501|1997-04-09|1997-04-16|7.0
10504|1997-04-11|1997-04-18|7.0
10505|1997-04-14|1997-04-21|7.0
10507|1997-04-15|1997-04-22|7.0
10516|1997-04-24|1997-05-01|7.0
10539|1997-05-16|1997-05-23|7.0
10548|1997-05-26|1997-06-02|7.0
10552|1997-05-29|1997-06-05|7.0
10565|1997-06-11|1997-06-18|7.0
10572|1997-06-18|1997-06-25|7.0
10576|1997-06-23|1997-06-30|7.0
10577|1997-06-23|1997-06-30|7.0
10586|1997-07-02|1997-07-09|7.0
10587|1997-07-02|1997-07-09|7.0
10588|1997-07-03|1997-07-10|7.0
10590|1997-07-07|1997-07-14|7.0
10594|1997-07-09|1997-07-16|7.0
10597|1997-07-11|1997-07-18|7.0
10611|1997-07-25|1997-08-01|7.0
10615|1997-07-30|1997-08-06|7.0
10618|1997-08-01|1997-08-08|7.0
10636|1997-08-19|1997-08-26|7.0
10637|1997-08-19|1997-08-26|7.0
10639|1997-08-20|1997-08-27|7.0
10640|1997-08-21|1997-08-28|7.0
10644|1997-08-25|1997-09-01|7.0
10645|1997-08-26|1997-09-02|7.0
10646|1997-08-27|1997-09-03|7.0
10647|1997-08-27|1997-09-03|7.0
10652|1997-09-01|1997-09-08|7.0
10667|1997-09-12|1997-09-19|7.0
10669|1997-09-15|1997-09-22|7.0
10671|1997-09-17|1997-09-24|7.0
10676|1997-09-22|1997-09-29|7.0
10679|1997-09-23|1997-09-30|7.0
10695|1997-10-07|1997-10-14|7.0
10707|1997-10-16|1997-10-23|7.0
10728|1997-11-04|1997-11-11|7.0
10737|1997-11-11|1997-11-18|7.0
10744|1997-11-17|1997-11-24|7.0
10747|1997-11-19|1997-11-26|7.0
10762|1997-12-02|1997-12-09|7.0
10768|1997-12-08|1997-12-15|7.0
10787|1997-12-19|1997-12-26|7.0
10803|1997-12-30|1998-01-06|7.0
10817|1998-01-06|1998-01-13|7.0
10821|1998-01-08|1998-01-15|7.0
10837|1998-01-16|1998-01-23|7.0
10849|1998-01-23|1998-01-30|7.0
10850|1998-01-23|1998-01-30|7.0
10851|1998-01-26|1998-02-02|7.0
10853|1998-01-27|1998-02-03|7.0
10864|1998-02-02|1998-02-09|7.0
10881|1998-02-11|1998-02-18|7.0
10888|1998-02-16|1998-02-23|7.0
10889|1998-02-16|1998-02-23|7.0
10911|1998-02-26|1998-03-05|7.0
10926|1998-03-04|1998-03-11|7.0
10929|1998-03-05|1998-03-12|7.0
10942|1998-03-11|1998-03-18|7.0
10946|1998-03-12|1998-03-19|7.0
10950|1998-03-16|1998-03-23|7.0
10963|1998-03-19|1998-03-26|7.0
10969|1998-03-23|1998-03-30|7.0
10994|1998-04-02|1998-04-09|7.0
10999|1998-04-03|1998-04-10|7.0
11017|1998-04-13|1998-04-20|7.0
11021|1998-04-14|1998-04-21|7.0
11031|1998-04-17|1998-04-24|7.0
11034|1998-04-20|1998-04-27|7.0
11043|1998-04-22|1998-04-29|7.0
11047|1998-04-24|1998-05-01|7.0
11055|1998-04-28|1998-05-05|7.0
10253|1996-07-10|1996-07-16|6.0
10257|1996-07-16|1996-07-22|6.0
10258|1996-07-17|1996-07-23|6.0
10276|1996-08-08|1996-08-14|6.0
10282|1996-08-15|1996-08-21|6.0
10285|1996-08-20|1996-08-26|6.0
10287|1996-08-22|1996-08-28|6.0
10294|1996-08-30|1996-09-05|6.0
10297|1996-09-04|1996-09-10|6.0
10298|1996-09-05|1996-09-11|6.0
10308|1996-09-18|1996-09-24|6.0
10311|1996-09-20|1996-09-26|6.0
10343|1996-10-31|1996-11-06|6.0
10352|1996-11-12|1996-11-18|6.0
10354|1996-11-14|1996-11-20|6.0
10373|1996-12-05|1996-12-11|6.0
10385|1996-12-17|1996-12-23|6.0
10397|1996-12-27|1997-01-02|6.0
10403|1997-01-03|1997-01-09|6.0
10406|1997-01-07|1997-01-13|6.0
10408|1997-01-08|1997-01-14|6.0
10420|1997-01-21|1997-01-27|6.0
10421|1997-01-21|1997-01-27|6.0
10436|1997-02-05|1997-02-11|6.0
10452|1997-02-20|1997-02-26|6.0
10457|1997-02-25|1997-03-03|6.0
10458|1997-02-26|1997-03-04|6.0
10485|1997-03-25|1997-03-31|6.0
10488|1997-03-27|1997-04-02|6.0
10513|1997-04-22|1997-04-28|6.0
10522|1997-04-30|1997-05-06|6.0
10524|1997-05-01|1997-05-07|6.0
10542|1997-05-20|1997-05-26|6.0
10554|1997-05-30|1997-06-05|6.0
10558|1997-06-04|1997-06-10|6.0
10564|1997-06-10|1997-06-16|6.0
10566|1997-06-12|1997-06-18|6.0
10581|1997-06-26|1997-07-02|6.0
10599|1997-07-15|1997-07-21|6.0
10601|1997-07-16|1997-07-22|6.0
10609|1997-07-24|1997-07-30|6.0
10621|1997-08-05|1997-08-11|6.0
10625|1997-08-08|1997-08-14|6.0
10630|1997-08-13|1997-08-19|6.0
10634|1997-08-15|1997-08-21|6.0
10656|1997-09-04|1997-09-10|6.0
10661|1997-09-09|1997-09-15|6.0
10665|1997-09-11|1997-09-17|6.0
10682|1997-09-25|1997-10-01|6.0
10688|1997-10-01|1997-10-07|6.0
10689|1997-10-01|1997-10-07|6.0
10696|1997-10-08|1997-10-14|6.0
10697|1997-10-08|1997-10-14|6.0
10700|1997-10-10|1997-10-16|6.0
10703|1997-10-14|1997-10-20|6.0
10715|1997-10-23|1997-10-29|6.0
10722|1997-10-29|1997-11-04|6.0
10724|1997-10-30|1997-11-05|6.0
10738|1997-11-12|1997-11-18|6.0
10758|1997-11-28|1997-12-04|6.0
10761|1997-12-02|1997-12-08|6.0
10785|1997-12-18|1997-12-24|6.0
10809|1998-01-01|1998-01-07|6.0
10810|1998-01-01|1998-01-07|6.0
10811|1998-01-02|1998-01-08|6.0
10820|1998-01-07|1998-01-13|6.0
10835|1998-01-15|1998-01-21|6.0
10848|1998-01-23|1998-01-29|6.0
10860|1998-01-29|1998-02-04|6.0
10885|1998-02-12|1998-02-18|6.0
10897|1998-02-19|1998-02-25|6.0
10899|1998-02-20|1998-02-26|6.0
10906|1998-02-25|1998-03-03|6.0
10910|1998-02-26|1998-03-04|6.0
10913|1998-02-26|1998-03-04|6.0
10920|1998-03-03|1998-03-09|6.0
10921|1998-03-03|1998-03-09|6.0
10938|1998-03-10|1998-03-16|6.0
10945|1998-03-12|1998-03-18|6.0
10948|1998-03-13|1998-03-19|6.0
10981|1998-03-27|1998-04-02|6.0
10987|1998-03-31|1998-04-06|6.0
10990|1998-04-01|1998-04-07|6.0
10991|1998-04-01|1998-04-07|6.0
11028|1998-04-16|1998-04-22|6.0
11032|1998-04-17|1998-04-23|6.0
11033|1998-04-17|1998-04-23|6.0
11037|1998-04-21|1998-04-27|6.0
11041|1998-04-22|1998-04-28|6.0
11048|1998-04-24|1998-04-30|6.0
11063|1998-04-30|1998-05-06|6.0
10249|1996-07-05|1996-07-10|5.0
10266|1996-07-26|1996-07-31|5.0
10292|1996-08-28|1996-09-02|5.0
10304|1996-09-12|1996-09-17|5.0
10325|1996-10-09|1996-10-14|5.0
10331|1996-10-16|1996-10-21|5.0
10337|1996-10-24|1996-10-29|5.0
10342|1996-10-30|1996-11-04|5.0
10355|1996-11-15|1996-11-20|5.0
10359|1996-11-21|1996-11-26|5.0
10365|1996-11-27|1996-12-02|5.0
10372|1996-12-04|1996-12-09|5.0
10404|1997-01-03|1997-01-08|5.0
10409|1997-01-09|1997-01-14|5.0
10410|1997-01-10|1997-01-15|5.0
10446|1997-02-14|1997-02-19|5.0
10453|1997-02-21|1997-02-26|5.0
10461|1997-02-28|1997-03-05|5.0
10467|1997-03-06|1997-03-11|5.0
10468|1997-03-07|1997-03-12|5.0
10481|1997-03-20|1997-03-25|5.0
10503|1997-04-11|1997-04-16|5.0
10517|1997-04-24|1997-04-29|5.0
10537|1997-05-14|1997-05-19|5.0
10567|1997-06-12|1997-06-17|5.0
10580|1997-06-26|1997-07-01|5.0
10600|1997-07-16|1997-07-21|5.0
10602|1997-07-17|1997-07-22|5.0
10616|1997-07-31|1997-08-05|5.0
10622|1997-08-06|1997-08-11|5.0
10623|1997-08-07|1997-08-12|5.0
10632|1997-08-14|1997-08-19|5.0
10650|1997-08-29|1997-09-03|5.0
10659|1997-09-05|1997-09-10|5.0
10681|1997-09-25|1997-09-30|5.0
10683|1997-09-26|1997-10-01|5.0
10706|1997-10-16|1997-10-21|5.0
10714|1997-10-22|1997-10-27|5.0
10717|1997-10-24|1997-10-29|5.0
10725|1997-10-31|1997-11-05|5.0
10734|1997-11-07|1997-11-12|5.0
10739|1997-11-12|1997-11-17|5.0
10756|1997-11-27|1997-12-02|5.0
10763|1997-12-03|1997-12-08|5.0
10764|1997-12-03|1997-12-08|5.0
10765|1997-12-04|1997-12-09|5.0
10773|1997-12-11|1997-12-16|5.0
10782|1997-12-17|1997-12-22|5.0
10806|1997-12-31|1998-01-05|5.0
10818|1998-01-07|1998-01-12|5.0
10825|1998-01-09|1998-01-14|5.0
10832|1998-01-14|1998-01-19|5.0
10836|1998-01-16|1998-01-21|5.0
10843|1998-01-21|1998-01-26|5.0
10844|1998-01-21|1998-01-26|5.0
10858|1998-01-29|1998-02-03|5.0
10869|1998-02-04|1998-02-09|5.0
10871|1998-02-05|1998-02-10|5.0
10874|1998-02-06|1998-02-11|5.0
10895|1998-02-18|1998-02-23|5.0
10959|1998-03-18|1998-03-23|5.0
10979|1998-03-26|1998-03-31|5.0
11007|1998-04-08|1998-04-13|5.0
11014|1998-04-10|1998-04-15|5.0
11024|1998-04-15|1998-04-20|5.0
10250|1996-07-08|1996-07-12|4.0
10272|1996-08-02|1996-08-06|4.0
10277|1996-08-09|1996-08-13|4.0
10278|1996-08-12|1996-08-16|4.0
10326|1996-10-10|1996-10-14|4.0
10332|1996-10-17|1996-10-21|4.0
10338|1996-10-25|1996-10-29|4.0
10344|1996-11-01|1996-11-05|4.0
10367|1996-11-28|1996-12-02|4.0
10374|1996-12-05|1996-12-09|4.0
10376|1996-12-09|1996-12-13|4.0
10377|1996-12-09|1996-12-13|4.0
10384|1996-12-16|1996-12-20|4.0
10389|1996-12-20|1996-12-24|4.0
10424|1997-01-23|1997-01-27|4.0
10430|1997-01-30|1997-02-03|4.0
10454|1997-02-21|1997-02-25|4.0
10469|1997-03-10|1997-03-14|4.0
10480|1997-03-20|1997-03-24|4.0
10498|1997-04-07|1997-04-11|4.0
10530|1997-05-08|1997-05-12|4.0
10546|1997-05-23|1997-05-27|4.0
10553|1997-05-30|1997-06-03|4.0
10583|1997-06-30|1997-07-04|4.0
10584|1997-06-30|1997-07-04|4.0
10595|1997-07-10|1997-07-14|4.0
10598|1997-07-14|1997-07-18|4.0
10612|1997-07-28|1997-08-01|4.0
10617|1997-07-31|1997-08-04|4.0
10641|1997-08-22|1997-08-26|4.0
10675|1997-09-19|1997-09-23|4.0
10677|1997-09-22|1997-09-26|4.0
10684|1997-09-26|1997-09-30|4.0
10685|1997-09-29|1997-10-03|4.0
10693|1997-10-06|1997-10-10|4.0
10699|1997-10-09|1997-10-13|4.0
10741|1997-11-14|1997-11-18|4.0
10742|1997-11-14|1997-11-18|4.0
10743|1997-11-17|1997-11-21|4.0
10752|1997-11-24|1997-11-28|4.0
10766|1997-12-05|1997-12-09|4.0
10769|1997-12-08|1997-12-12|4.0
10784|1997-12-18|1997-12-22|4.0
10786|1997-12-19|1997-12-23|4.0
10790|1997-12-22|1997-12-26|4.0
10802|1997-12-29|1998-01-02|4.0
10813|1998-01-05|1998-01-09|4.0
10823|1998-01-09|1998-01-13|4.0
10834|1998-01-15|1998-01-19|4.0
10838|1998-01-19|1998-01-23|4.0
10852|1998-01-26|1998-01-30|4.0
10859|1998-01-29|1998-02-02|4.0
10872|1998-02-05|1998-02-09|4.0
10949|1998-03-13|1998-03-17|4.0
10962|1998-03-19|1998-03-23|4.0
10964|1998-03-20|1998-03-24|4.0
10984|1998-03-30|1998-04-03|4.0
10995|1998-04-02|1998-04-06|4.0
11011|1998-04-09|1998-04-13|4.0
11027|1998-04-16|1998-04-20|4.0
11035|1998-04-20|1998-04-24|4.0
11052|1998-04-27|1998-05-01|4.0
11060|1998-04-30|1998-05-04|4.0
10255|1996-07-12|1996-07-15|3.0
10262|1996-07-22|1996-07-25|3.0
10268|1996-07-30|1996-08-02|3.0
10279|1996-08-13|1996-08-16|3.0
10318|1996-10-01|1996-10-04|3.0
10327|1996-10-11|1996-10-14|3.0
10328|1996-10-14|1996-10-17|3.0
10346|1996-11-05|1996-11-08|3.0
10362|1996-11-25|1996-11-28|3.0
10368|1996-11-29|1996-12-02|3.0
10375|1996-12-06|1996-12-09|3.0
10382|1996-12-13|1996-12-16|3.0
10390|1996-12-23|1996-12-26|3.0
10414|1997-01-14|1997-01-17|3.0
10435|1997-02-04|1997-02-07|3.0
10439|1997-02-07|1997-02-10|3.0
10456|1997-02-25|1997-02-28|3.0
10460|1997-02-28|1997-03-03|3.0
10470|1997-03-11|1997-03-14|3.0
10490|1997-03-31|1997-04-03|3.0
10496|1997-04-04|1997-04-07|3.0
10497|1997-04-04|1997-04-07|3.0
10511|1997-04-18|1997-04-21|3.0
10512|1997-04-21|1997-04-24|3.0
10519|1997-04-28|1997-05-01|3.0
10521|1997-04-29|1997-05-02|3.0
10528|1997-05-06|1997-05-09|3.0
10532|1997-05-09|1997-05-12|3.0
10549|1997-05-27|1997-05-30|3.0
10557|1997-06-03|1997-06-06|3.0
10560|1997-06-06|1997-06-09|3.0
10561|1997-06-06|1997-06-09|3.0
10562|1997-06-09|1997-06-12|3.0
10607|1997-07-22|1997-07-25|3.0
10613|1997-07-29|1997-08-01|3.0
10614|1997-07-29|1997-08-01|3.0
10619|1997-08-04|1997-08-07|3.0
10633|1997-08-15|1997-08-18|3.0
10635|1997-08-18|1997-08-21|3.0
10658|1997-09-05|1997-09-08|3.0
10694|1997-10-06|1997-10-09|3.0
10710|1997-10-20|1997-10-23|3.0
10716|1997-10-24|1997-10-27|3.0
10733|1997-11-07|1997-11-10|3.0
10750|1997-11-21|1997-11-24|3.0
10776|1997-12-15|1997-12-18|3.0
10839|1998-01-19|1998-01-22|3.0
10862|1998-01-30|1998-02-02|3.0
10873|1998-02-06|1998-02-09|3.0
10876|1998-02-09|1998-02-12|3.0
10887|1998-02-13|1998-02-16|3.0
10901|1998-02-23|1998-02-26|3.0
10904|1998-02-24|1998-02-27|3.0
10914|1998-02-27|1998-03-02|3.0
10915|1998-02-27|1998-03-02|3.0
10934|1998-03-09|1998-03-12|3.0
10937|1998-03-10|1998-03-13|3.0
10939|1998-03-10|1998-03-13|3.0
10947|1998-03-13|1998-03-16|3.0
10954|1998-03-17|1998-03-20|3.0
10955|1998-03-17|1998-03-20|3.0
10956|1998-03-17|1998-03-20|3.0
10973|1998-03-24|1998-03-27|3.0
10985|1998-03-30|1998-04-02|3.0
11005|1998-04-07|1998-04-10|3.0
11016|1998-04-10|1998-04-13|3.0
11018|1998-04-13|1998-04-16|3.0
11056|1998-04-28|1998-05-01|3.0
11064|1998-05-01|1998-05-04|3.0
11066|1998-05-01|1998-05-04|3.0
10252|1996-07-09|1996-07-11|2.0
10256|1996-07-15|1996-07-17|2.0
10275|1996-08-07|1996-08-09|2.0
10289|1996-08-26|1996-08-28|2.0
10324|1996-10-08|1996-10-10|2.0
10335|1996-10-22|1996-10-24|2.0
10336|1996-10-23|1996-10-25|2.0
10347|1996-11-06|1996-11-08|2.0
10379|1996-12-11|1996-12-13|2.0
10383|1996-12-16|1996-12-18|2.0
10387|1996-12-18|1996-12-20|2.0
10412|1997-01-13|1997-01-15|2.0
10413|1997-01-14|1997-01-16|2.0
10443|1997-02-12|1997-02-14|2.0
10463|1997-03-04|1997-03-06|2.0
10479|1997-03-19|1997-03-21|2.0
10487|1997-03-26|1997-03-28|2.0
10520|1997-04-29|1997-05-01|2.0
10527|1997-05-05|1997-05-07|2.0
10529|1997-05-07|1997-05-09|2.0
10534|1997-05-12|1997-05-14|2.0
10543|1997-05-21|1997-05-23|2.0
10555|1997-06-02|1997-06-04|2.0
10570|1997-06-17|1997-06-19|2.0
10670|1997-09-16|1997-09-18|2.0
10680|1997-09-24|1997-09-26|2.0
10701|1997-10-13|1997-10-15|2.0
10713|1997-10-22|1997-10-24|2.0
10718|1997-10-27|1997-10-29|2.0
10721|1997-10-29|1997-10-31|2.0
10746|1997-11-19|1997-11-21|2.0
10753|1997-11-25|1997-11-27|2.0
10754|1997-11-25|1997-11-27|2.0
10755|1997-11-26|1997-11-28|2.0
10781|1997-12-17|1997-12-19|2.0
10801|1997-12-29|1997-12-31|2.0
10878|1998-02-10|1998-02-12|2.0
10879|1998-02-10|1998-02-12|2.0
10890|1998-02-16|1998-02-18|2.0
10891|1998-02-17|1998-02-19|2.0
10892|1998-02-17|1998-02-19|2.0
10893|1998-02-18|1998-02-20|2.0
10894|1998-02-18|1998-02-20|2.0
10907|1998-02-25|1998-02-27|2.0
10919|1998-03-02|1998-03-04|2.0
10922|1998-03-03|1998-03-05|2.0
10972|1998-03-24|1998-03-26|2.0
10975|1998-03-25|1998-03-27|2.0
10989|1998-03-31|1998-04-02|2.0
10992|1998-04-01|1998-04-03|2.0
11003|1998-04-06|1998-04-08|2.0
11009|1998-04-08|1998-04-10|2.0
11020|1998-04-14|1998-04-16|2.0
11036|1998-04-20|1998-04-22|2.0
11053|1998-04-27|1998-04-29|2.0
11057|1998-04-29|1998-05-01|2.0
11067|1998-05-04|1998-05-06|2.0
11069|1998-05-04|1998-05-06|2.0
10270|1996-08-01|1996-08-02|1.0
10381|1996-12-12|1996-12-13|1.0
10388|1996-12-19|1996-12-20|1.0
10459|1997-02-27|1997-02-28|1.0
10538|1997-05-15|1997-05-16|1.0
10573|1997-06-19|1997-06-20|1.0
10631|1997-08-14|1997-08-15|1.0
10649|1997-08-28|1997-08-29|1.0
10673|1997-09-18|1997-09-19|1.0
10690|1997-10-02|1997-10-03|1.0
10732|1997-11-06|1997-11-07|1.0
10774|1997-12-11|1997-12-12|1.0
10783|1997-12-18|1997-12-19|1.0
10846|1998-01-22|1998-01-23|1.0
10884|1998-02-12|1998-02-13|1.0
10944|1998-03-12|1998-03-13|1.0
11013|1998-04-09|1998-04-10|1.0
11046|1998-04-23|1998-04-24|1.0

--5. Continuing with the previous query, I need the average time lag for each shipper.

select shipperid, avg(julianday(shippeddate)-julianday(orderdate)) as avg_lag from orders group by shipperid order by avg_lag;
ShipperID|avg_lag
3|7.47389558232932
1|8.57142857142857
2|9.23492063492063

--6. I am doing inventory, and I need to know the total price of each product on hand, that is, the price of each product line, sorted alphabetically by product name.

select productid, productname, unitsinstock, unitprice, unitsinstock * unitprice as total from products where unitsinstock > 0 order by productname;
ProductID|ProductName|UnitsInStock|UnitPrice|total
3|Aniseed Syrup|13|10.0|130.0
40|Boston Crab Meat|123|18.4|2263.2
60|Camembert Pierrot|19|34.0|646.0
18|Carnarvon Tigers|42|62.5|2625.0
1|Chai|39|18.0|702.0
2|Chang|17|19.0|323.0
39|Chartreuse verte|69|18.0|1242.0
4|Chef Anton's Cajun Seasoning|53|22.0|1166.0
48|Chocolade|15|12.75|191.25
38|CÃ´te de Blaye|17|263.5|4479.5
58|Escargots de Bourgogne|62|13.25|821.5
52|Filo Mix|38|7.0|266.0
71|Flotemysost|26|21.5|559.0
33|Geitost|112|2.5|280.0
15|Genen Shouyu|39|15.5|604.5
56|Gnocchi di nonna Alice|21|38.0|798.0
6|Grandma's Boysenberry Spread|120|25.0|3000.0
37|Gravad lax|11|26.0|286.0
24|GuaranÃ¡ FantÃ¡stica|20|4.5|90.0
69|Gudbrandsdalsost|26|36.0|936.0
44|Gula Malacca|27|19.45|525.15
26|GumbÃ¤r GummibÃ¤rchen|15|31.23|468.45
22|Gustaf's KnÃ¤ckebrÃ¶d|104|21.0|2184.0
10|Ikura|31|31.0|961.0
36|Inlagd Sill|112|19.0|2128.0
43|Ipoh Coffee|17|46.0|782.0
41|Jack's New England Clam Chowder|85|9.65|820.25
13|Konbu|24|6.0|144.0
76|LakkalikÃ¶Ã¶ri|57|18.0|1026.0
67|Laughing Lumberjack Lager|52|14.0|728.0
74|Longlife Tofu|4|10.0|40.0
65|Louisiana Fiery Hot Pepper Sauce|76|21.05|1599.8
66|Louisiana Hot Spiced Okra|4|17.0|68.0
51|Manjimup Dried Apples|20|53.0|1060.0
32|Mascarpone Fabioli|9|32.0|288.0
49|Maxilaku|10|20.0|200.0
9|Mishi Kobe Niku|29|97.0|2813.0
72|Mozzarella di Giovanni|14|34.8|487.2
30|Nord-Ost Matjeshering|10|25.89|258.9
8|Northwoods Cranberry Sauce|6|40.0|240.0
25|NuNuCa NuÃŸ-Nougat-Creme|76|14.0|1064.0
77|Original Frankfurter grÃ¼ne SoÃŸe|32|13.0|416.0
70|Outback Lager|15|15.0|225.0
16|Pavlova|29|17.45|506.05
55|PÃ¢tÃ© chinois|115|24.0|2760.0
11|Queso Cabrales|22|21.0|462.0
12|Queso Manchego La Pastora|86|38.0|3268.0
59|Raclette Courdavault|79|55.0|4345.0
57|Ravioli Angelo|36|19.5|702.0
75|RhÃ¶nbrÃ¤u Klosterbier|125|7.75|968.75
45|Rogede sild|5|9.5|47.5
73|RÃ¶d Kaviar|101|15.0|1515.0
28|RÃ¶ssle Sauerkraut|26|45.6|1185.6
34|Sasquatch Ale|111|14.0|1554.0
27|Schoggi Schokolade|49|43.9|2151.1
68|Scottish Longbreads|6|12.5|75.0
42|Singaporean Hokkien Fried Mee|26|14.0|364.0
20|Sir Rodney's Marmalade|40|81.0|3240.0
21|Sir Rodney's Scones|3|10.0|30.0
61|Sirop d'Ã©rable|113|28.5|3220.5
46|Spegesild|95|12.0|1140.0
35|Steeleye Stout|20|18.0|360.0
62|Tarte au sucre|17|49.3|838.1
19|Teatime Chocolate Biscuits|25|9.2|230.0
14|Tofu|35|23.25|813.75
54|TourtiÃ¨re|21|7.45|156.45
23|TunnbrÃ¶d|61|9.0|549.0
7|Uncle Bob's Organic Dried Pears|15|30.0|450.0
50|Valkoinen suklaa|65|16.25|1056.25
63|Vegie-spread|24|43.9|1053.6
64|Wimmers gute SemmelknÃ¶del|22|33.25|731.5
47|Zaanse koeken|36|9.5|342.0

--7. What is the dollar total we have tied up in inventory?

select sum(unitsinstock * unitprice) from products;
sum(unitsinstock * unitprice)
74050.85

--8. We have discovered that some customers favor certain employees. I need to know this information. I need a report of the most common employee/customer pairs, the number of times the employee took orders from the customer, and the number of orders. Alphabetize this by customer id. Omit customer/employee pairs whre the number of orders is less than five.



--9. How many days were in the service (if you are a veteran), or how many days will you serve (assuming you know your ETS date)?

select julianday('2021-05-31')-julianday('2001-03-13') as days_in_service;
days_in_service
7384.0

--10. Answer these questions using the built in time and date function.  
--â€¢ What is todayâ€™s date?  
--â€¢ What was the first day of the month?  
--â€¢ What will be the first day of the next   month?  
--â€¢ What is the last day of this month?
